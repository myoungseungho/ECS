# Unity Client — Manager 간 상호작용 맵
# AI 에이전트가 "이 Manager를 수정하면 어디에 영향을 주는지" 즉시 파악하기 위한 문서
# Manager 추가/수정 시 반드시 이 파일도 갱신

version: session_s052_durability_repair_reroll

# ━━━ Manager 목록 및 의존 관계 ━━━

managers:

  - name: NetworkManager
    namespace: Network
    singleton: true
    dont_destroy_on_load: true
    purpose: "Gate→Field TCP 연결 관리 + 패킷 수신/발송 + 이벤트 디스패치"
    reads:
      - TCPClient._recvQueue (메인 스레드에서 DequeueAll)
    writes:
      - ConnectionState (State 프로퍼티)
      - MyEntityId, CurrentZone, CurrentChannel
    fires_events:
      - OnLoginResult(LoginResult, uint)
      - OnCharacterList(CharacterInfo[])
      - OnEnterGame(EnterGameResult)
      - OnEntityAppear(ulong, float, float, float)
      - OnEntityDisappear(ulong)
      - OnEntityMove(ulong, float, float, float)
      - OnZoneChanged(int)
      - OnChannelChanged(int)
      - OnStatSync(StatSyncData)
      - OnAttackResult(AttackResultData)
      - OnCombatDied(CombatDiedData)
      - OnRespawnResult(RespawnResultData)
      - OnError(string)
      - OnDisconnected()
    subscribes_to: []
    public_api:
      - ConnectToGate()
      - ConnectDirect(string, int)
      - Login(string, string)
      - RequestCharList()
      - SelectCharacter(uint)
      - JoinChannel(int)
      - SendMove(float, float, float)
      - EnterZone(int)
      - RequestStatSync()
      - SendAttack(ulong)
      - RequestRespawn()
      - DisconnectAll()

  - name: GameManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: true
    purpose: "게임 상태 머신 (Login → CharSelect → InGame)"
    reads: []
    writes:
      - CurrentState (GameState enum)
    fires_events: []
    subscribes_to:
      - NetworkManager.OnLoginResult → CharSelect 전이
      - NetworkManager.OnEnterGame → InGame 전이
      - NetworkManager.OnDisconnected → Login 리셋

  - name: EntityManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "엔티티 생명주기 관리 (생성/파괴/이동)"
    reads:
      - EntityPool.Instance (오브젝트 풀 접근)
    writes:
      - _entityMap (Dictionary<ulong, GameObject>)
      - _localPlayer (GameObject)
    fires_events: []
    subscribes_to:
      - NetworkManager.OnEnterGame → 로컬 플레이어 생성
      - NetworkManager.OnEntityAppear → 리모트 플레이어 생성
      - NetworkManager.OnEntityDisappear → 리모트 플레이어 제거
      - NetworkManager.OnEntityMove → 리모트 플레이어 위치 업데이트
      - NetworkManager.OnDisconnected → 전체 엔티티 정리
    serialized_fields:
      - localPlayerPrefab: GameObject (LocalPlayer.prefab)
      - remotePlayerPrefab: GameObject (RemotePlayer.prefab)
      - usePooling: bool (default true)

  - name: EntityPool
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "RemotePlayer 오브젝트 풀링"
    reads: []
    writes:
      - _pool (Queue<GameObject>)
    fires_events: []
    subscribes_to: []
    serialized_fields:
      - prefab: GameObject (RemotePlayer.prefab)
      - preloadCount: int (default 50)

  - name: MonsterManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "몬스터 엔티티 생명주기 관리 (스폰/사망/리스폰/이동/HP 갱신/어그로)"
    reads:
      - CoordConverter (서버→Unity 좌표 변환)
    writes:
      - _monsterMap (Dictionary<ulong, MonsterEntity>)
    fires_events:
      - OnMonsterSpawned(MonsterEntity)
      - OnMonsterDied(ulong)
      - OnMonsterUpdated(MonsterEntity)
      - OnMonsterAggroChanged(ulong, ulong)
    subscribes_to:
      - NetworkManager.OnMonsterSpawn → 몬스터 생성
      - NetworkManager.OnMonsterRespawn → 몬스터 리스폰 (HP 리셋 + 재배치)
      - NetworkManager.OnCombatDied → 몬스터 사망 처리
      - NetworkManager.OnEntityMove → 몬스터 위치 업데이트
      - NetworkManager.OnAttackResult → 몬스터 HP 갱신
      - NetworkManager.OnDisconnected → 전체 몬스터 정리
      - NetworkManager.OnMonsterMove → 몬스터 이동 (서버 AI)
      - NetworkManager.OnMonsterAggro → 몬스터 어그로 변경
    public_api:
      - GetMonster(ulong) → MonsterEntity
      - IsMonster(ulong) → bool
    serialized_fields:
      - monsterPrefab: GameObject (Monster.prefab, optional)

  - name: StatsManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "내 캐릭터 스탯 동기화 및 관리"
    reads: []
    writes:
      - Level, HP, MaxHP, MP, MaxMP, ATK, DEF, EXP, EXPNext
    fires_events:
      - OnStatsChanged()
    subscribes_to:
      - NetworkManager.OnStatSync → 스탯 데이터 갱신
      - NetworkManager.OnEnterGame → 자동 STAT_QUERY 전송
    public_api: []
    computed_properties:
      - IsAlive (HP > 0)
      - HpRatio (HP / MaxHP)
      - MpRatio (MP / MaxMP)
      - ExpRatio (EXP / EXPNext)

  - name: CombatManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "전투 관리 — 공격, 사망, 부활 처리"
    reads:
      - NetworkManager.Instance.MyEntityId (사망 판정)
    writes:
      - IsDead, SelectedTarget
    fires_events:
      - OnAttackFeedback(AttackResultData)
      - OnEntityDied(CombatDiedData)
      - OnRespawnComplete(RespawnResultData)
    subscribes_to:
      - NetworkManager.OnAttackResult → 공격 결과 전달
      - NetworkManager.OnCombatDied → 사망 처리
      - NetworkManager.OnRespawnResult → 부활 처리
    public_api:
      - SelectTarget(ulong)
      - Attack(ulong)
      - Respawn()

  - name: SkillManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "스킬 시스템 관리 — 스킬 목록, 쿨다운, 사용, 레벨업"
    reads: []
    writes:
      - _skills (Dictionary<uint, SkillInfo>)
      - _cooldowns (Dictionary<uint, float>)
      - _skillPoints (uint)
    fires_events:
      - OnSkillListChanged()
      - OnSkillUsed(SkillResultData)
      - OnCooldownStarted(uint)
      - OnSkillLeveledUp(SkillLevelUpResultData)
      - OnSkillPointsChanged(uint)
    subscribes_to:
      - NetworkManager.OnSkillList → 스킬 목록 갱신
      - NetworkManager.OnSkillResult → 스킬 결과 + 쿨다운 시작
      - NetworkManager.OnEnterGame → 자동 SKILL_LIST_REQ
      - NetworkManager.OnSkillLevelUpResult → 스킬 레벨업 결과
      - NetworkManager.OnSkillPointInfo → 스킬 포인트 갱신
    public_api:
      - UseSkill(uint, ulong)
      - IsOnCooldown(uint) → bool
      - GetCooldownRemaining(uint) → float
      - GetSkill(uint) → SkillInfo
      - LevelUpSkill(uint)
    computed_properties:
      - SkillPoints (uint)

  - name: InventoryManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "인벤토리 관리 — 아이템 목록, 사용, 장착/해제"
    reads: []
    writes:
      - _items (Dictionary<byte, InventoryItemInfo>)
    fires_events:
      - OnInventoryChanged()
      - OnItemAdded(ItemAddResultData)
      - OnItemUsed(ItemUseResultData)
      - OnItemEquipped(ItemEquipResultData)
    subscribes_to:
      - NetworkManager.OnInventoryResp → 인벤토리 목록 갱신
      - NetworkManager.OnItemAddResult → 아이템 추가 결과
      - NetworkManager.OnItemUseResult → 아이템 사용 결과
      - NetworkManager.OnItemEquipResult → 아이템 장착 결과
      - NetworkManager.OnEnterGame → 자동 INVENTORY_REQ
    public_api:
      - UseItem(byte)
      - EquipItem(byte)
      - UnequipItem(byte)
      - GetItem(byte) → InventoryItemInfo

  - name: PartyManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "파티 시스템 관리 — 생성, 초대, 수락, 탈퇴, 추방"
    reads:
      - NetworkManager.Instance.MyEntityId (리더 판정)
    writes:
      - PartyId, LeaderId, Members
    fires_events:
      - OnPartyChanged()
    subscribes_to:
      - NetworkManager.OnPartyInfo → 파티 정보 갱신
    public_api:
      - CreateParty()
      - InviteToParty(ulong)
      - AcceptParty(uint)
      - LeaveParty()
      - KickMember(ulong)
    computed_properties:
      - InParty (PartyId != 0)
      - IsLeader (LeaderId == MyEntityId)

  - name: BuffManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "버프 시스템 관리 — 목록, 적용, 제거, 타이머"
    reads: []
    writes:
      - _buffs (Dictionary<uint, BuffInfo>)
    fires_events:
      - OnBuffListChanged()
      - OnBuffApplied(BuffResultData)
      - OnBuffRemoved(uint)
    subscribes_to:
      - NetworkManager.OnBuffList → 버프 목록 갱신
      - NetworkManager.OnBuffResult → 버프 적용 결과
      - NetworkManager.OnBuffRemoveResp → 버프 제거 결과
      - NetworkManager.OnEnterGame → 자동 BUFF_LIST_REQ
    public_api:
      - ApplyBuff(uint)
      - RemoveBuff(uint)
      - HasBuff(uint) → bool
      - GetBuff(uint) → BuffInfo

  - name: ChatManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "채팅 시스템 관리 — Zone/Party/Whisper/System 메시지 송수신"
    reads: []
    writes:
      - _messages (List<ChatEntry>)
    fires_events:
      - OnNewMessage(ChatEntry)
    subscribes_to:
      - NetworkManager.OnChatMessage → 채팅 메시지 수신
      - NetworkManager.OnWhisperResult → 귓속말 결과
      - NetworkManager.OnSystemMessage → 시스템 메시지
    public_api:
      - SendZoneChat(string)
      - SendPartyChat(string)
      - SendWhisper(string, string)
    computed_properties:
      - Messages (IReadOnlyList<ChatEntry>)

  - name: ShopManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "NPC 상점 관리 — 아이템 목록, 구매/판매, 골드 추적"
    reads: []
    writes:
      - _isShopOpen (bool)
      - _currentNpcId (uint)
      - _currentItems (ShopItemInfo[])
      - _gold (uint)
    fires_events:
      - OnShopOpened(ShopListData)
      - OnShopClosed()
      - OnTransactionResult(ShopResultData)
      - OnGoldChanged(uint)
    subscribes_to:
      - NetworkManager.OnShopList → 상점 아이템 목록 수신
      - NetworkManager.OnShopResult → 거래 결과
    public_api:
      - OpenShop(uint)
      - BuyItem(uint, byte)
      - SellItem(byte)
      - CloseShop()
    computed_properties:
      - IsShopOpen (bool)
      - CurrentNpcId (uint)
      - CurrentItems (ShopItemInfo[])
      - Gold (uint)

  - name: BossManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "보스 시스템 관리 — HP 추적, 페이즈 전환, 특수 공격, 인레이지"
    reads: []
    writes:
      - _bosses (Dictionary<ulong, BossState>)
    fires_events:
      - OnBossAppeared(BossState)
      - OnBossPhaseChanged(BossState)
      - OnBossSpecialAttacked(BossSpecialAttackData)
      - OnBossEnraged(BossState)
      - OnBossKilled(BossDefeatedData)
      - OnBossHPChanged(BossState)
    subscribes_to:
      - NetworkManager.OnBossSpawn → 보스 출현
      - NetworkManager.OnBossPhaseChange → 페이즈 전환
      - NetworkManager.OnBossSpecialAttack → 특수 공격
      - NetworkManager.OnBossEnrage → 인레이지
      - NetworkManager.OnBossDefeated → 보스 처치
      - NetworkManager.OnAttackResult → 보스 HP 갱신
    public_api:
      - GetBoss(ulong) → BossState
      - IsBoss(ulong) → bool

  - name: SceneFlowManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: true
    purpose: "씬 전환 매니저 — 페이드인/아웃 트랜지션 + 씬 흐름 순서 관리"
    reads: []
    writes:
      - CurrentScene (GameScene enum)
    fires_events:
      - OnSceneChanged(GameScene)
    subscribes_to: []
    public_api:
      - TransitionTo(GameScene)
      - TransitionToNext()
    serialized_fields:
      - fadeDuration: float (default 0.5)

  - name: NpcManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "NPC 인터랙션 관리 — F키로 NPC 대화, 대화 데이터 관리"
    reads: []
    writes:
      - _currentDialog (NpcDialogData)
      - _isDialogOpen (bool)
    fires_events:
      - OnDialogOpened(NpcDialogData)
      - OnDialogClosed()
    subscribes_to:
      - NetworkManager.OnNpcDialog → NPC 대화 데이터 수신
    public_api:
      - InteractWith(uint)
      - CloseDialog()
    computed_properties:
      - IsDialogOpen (bool)
      - CurrentDialog (NpcDialogData)

  - name: EnhanceManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "장비 강화 관리 — 대장장이 NPC 연동, 강화 요청/결과"
    reads: []
    writes:
      - _isEnhancePanelOpen (bool)
    fires_events:
      - OnEnhanceComplete(EnhanceResultData)
      - OnEnhancePanelOpened()
      - OnEnhancePanelClosed()
    subscribes_to:
      - NetworkManager.OnEnhanceResult → 강화 결과 수신
    public_api:
      - Enhance(byte)
      - OpenPanel()
      - ClosePanel()
    computed_properties:
      - IsEnhancePanelOpen (bool)

  - name: TutorialManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "튜토리얼 진행 관리 — 5스텝 보상 시스템"
    reads: []
    writes:
      - _completedSteps (HashSet<byte>)
      - _currentStep (byte)
    fires_events:
      - OnStepCompleted(byte)
      - OnRewardReceived(TutorialRewardData)
      - OnTutorialFinished()
    subscribes_to:
      - NetworkManager.OnTutorialReward → 튜토리얼 보상 수신
    public_api:
      - CompleteCurrentStep()
      - CompleteStep(byte)
      - IsStepCompleted(byte) → bool
    computed_properties:
      - CurrentStep (byte)
      - IsComplete (bool)

  - name: GuildManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "문파(길드) 시스템 관리 — 생성/해산/초대/수락/탈퇴/추방/정보/목록"
    reads: []
    writes:
      - InGuild (bool)
      - GuildId (uint)
      - GuildName (string)
      - LeaderId (ulong)
      - Members (GuildMemberInfo[])
    fires_events:
      - OnGuildInfoUpdated(GuildInfoData)
      - OnGuildListReceived(GuildListEntry[])
      - OnGuildLeft()
    subscribes_to:
      - NetworkManager.OnGuildInfo → 문파 정보 갱신
      - NetworkManager.OnGuildList → 문파 목록 수신
    public_api:
      - CreateGuild(string)
      - DisbandGuild()
      - InviteMember(ulong)
      - AcceptInvite()
      - LeaveGuild()
      - KickMember(ulong)
      - RequestGuildInfo()
      - RequestGuildList()
    computed_properties:
      - IsLeader (bool)

  - name: TradeManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "거래 시스템 관리 — 요청/수락/거절/아이템·골드 추가/확정/취소"
    reads: []
    writes:
      - IsTrading (bool)
      - TradePartner (ulong)
    fires_events:
      - OnTradeCompleted(TradeResultData)
      - OnTradeStarted()
      - OnTradeCancelled()
    subscribes_to:
      - NetworkManager.OnTradeResult → 거래 결과
    public_api:
      - RequestTrade(ulong)
      - AcceptTrade()
      - DeclineTrade()
      - AddItem(byte)
      - AddGold(uint)
      - ConfirmTrade()
      - CancelTrade()

  - name: MailManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "우편 시스템 관리 — 발송/목록/읽기/수령/삭제"
    reads: []
    writes:
      - _mails (List<MailListEntry>)
      - IsMailboxOpen (bool)
    fires_events:
      - OnMailListChanged()
      - OnMailOpened(MailReadData)
      - OnClaimResult(MailClaimResultData)
      - OnDeleteResult(MailDeleteResultData)
    subscribes_to:
      - NetworkManager.OnMailList → 우편 목록 갱신
      - NetworkManager.OnMailRead → 우편 내용 수신
      - NetworkManager.OnMailClaimResult → 수령 결과
      - NetworkManager.OnMailDeleteResult → 삭제 결과
    public_api:
      - SendMail(string, string, string, uint, uint, ushort)
      - OpenMailbox()
      - CloseMailbox()
      - ReadMail(uint)
      - ClaimMail(uint)
      - DeleteMail(uint)
      - RefreshMailbox()
    computed_properties:
      - Mails (IReadOnlyList<MailListEntry>)

  - name: DungeonManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "던전 인스턴스 + 매칭 시스템 관리 — 생성/입장/퇴장/매칭 큐"
    reads: []
    writes:
      - InDungeon (bool)
      - CurrentInstanceId (uint)
      - CurrentDungeonType (uint)
      - PlayerCount (byte)
      - MonsterCount (byte)
      - CurrentMatchState (MatchState)
      - QueuePosition (uint)
    fires_events:
      - OnDungeonEntered(InstanceEnterData)
      - OnDungeonLeft()
      - OnDungeonInfoUpdated(InstanceInfoData)
      - OnMatchFound(MatchFoundData)
      - OnMatchStateChanged(MatchState)
    subscribes_to:
      - NetworkManager.OnInstanceEnter → 던전 입장 결과
      - NetworkManager.OnInstanceLeaveResult → 던전 퇴장 결과
      - NetworkManager.OnInstanceInfo → 던전 정보 갱신
      - NetworkManager.OnMatchFound → 매칭 발견
      - NetworkManager.OnMatchStatus → 매칭 상태 갱신
    public_api:
      - CreateDungeon(uint)
      - LeaveDungeon()
      - EnqueueMatch(uint)
      - DequeueMatch()
      - AcceptMatch()

  - name: PvPManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "PvP 아레나 관리 — S036 전용 패킷(350-359) 기반 매칭/전투/레이팅"
    reads: []
    writes:
      - CurrentState (PvPState)
      - CurrentMode (PvPMode)
      - QueueCount (ushort)
      - Rating (ushort)
      - Tier (string)
      - Wins (ushort)
      - Losses (ushort)
    fires_events:
      - OnStateChanged(PvPState)
      - OnMatchFound(PvPMatchFoundData)
      - OnMatchStarted(PvPMatchStartData)
      - OnAttackResult(PvPAttackResultData)
      - OnMatchEnded(PvPMatchEndData)
      - OnRatingUpdated(PvPRatingInfoData)
    subscribes_to:
      - NetworkManager.OnPvPQueueStatus → 큐 상태
      - NetworkManager.OnPvPMatchFound → PvP 매칭 발견
      - NetworkManager.OnPvPMatchStart → 매치 시작
      - NetworkManager.OnPvPAttackResult → 공격 결과
      - NetworkManager.OnPvPMatchEnd → 매치 종료
      - NetworkManager.OnPvPRatingInfo → 레이팅 정보
    public_api:
      - QueueForMatch(PvPMode)
      - CancelQueue()
      - AcceptMatch()
      - Attack(byte, byte, ushort, ushort)
      - LeaveMatch()

  - name: RaidManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "레이드 보스 관리 — S036 패킷(370-379) 기반 3페이즈/기믹6종/스태거/인레이지"
    reads: []
    writes:
      - CurrentState (RaidState)
      - InstanceId (uint)
      - BossName (string)
      - BossMaxHP (uint)
      - BossCurrentHP (uint)
      - CurrentPhase (byte)
      - MaxPhases (byte)
      - EnrageTimer (ushort)
      - StaggerGauge (byte)
      - IsEnraged (bool)
    fires_events:
      - OnBossSpawned(RaidBossSpawnData)
      - OnPhaseChanged(RaidPhaseChangeData)
      - OnMechanicStarted(RaidMechanicData)
      - OnMechanicResult(RaidMechanicResultData)
      - OnStaggerUpdated(byte)
      - OnEnraged()
      - OnWiped(RaidWipeData)
      - OnCleared(RaidClearData)
      - OnAttackResult(RaidAttackResultData)
    subscribes_to:
      - NetworkManager.OnRaidBossSpawn → 보스 스폰
      - NetworkManager.OnRaidPhaseChange → 페이즈 변경
      - NetworkManager.OnRaidMechanic → 기믹 발동
      - NetworkManager.OnRaidMechanicResult → 기믹 결과
      - NetworkManager.OnRaidStagger → 스태거 게이지
      - NetworkManager.OnRaidEnrage → 인레이지
      - NetworkManager.OnRaidWipe → 와이프
      - NetworkManager.OnRaidClear → 클리어
      - NetworkManager.OnRaidAttackResult → 공격 결과
      - NetworkManager.OnInstanceEnter → 레이드 인스턴스 입장
      - NetworkManager.OnInstanceLeaveResult → 퇴장
    public_api:
      - AttackBoss(ushort, uint)
      - LeaveRaid()
      - GetMechanicName(RaidMechanicId) → string

  - name: HitVFXManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "타격 이펙트 파티클 관리 — Object Pool 방식 ParticleSystem 스폰"
    reads: []
    writes:
      - _normalPool (Queue<ParticleSystem>)
      - _critPool (Queue<ParticleSystem>)
    fires_events: []
    subscribes_to:
      - CombatManager.OnAttackFeedback → 피격 위치에 이펙트 재생
    public_api:
      - PlayNormalHit(Vector3)
      - PlayCriticalHit(Vector3)

  - name: QuestManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "퀘스트 시스템 관리 — 목록, 수락, 진행, 완료"
    reads: []
    writes:
      - _quests (Dictionary<uint, QuestInfo>)
    fires_events:
      - OnQuestListChanged()
      - OnQuestAccepted(QuestAcceptResultData)
      - OnQuestCompleted(QuestCompleteResultData)
    subscribes_to:
      - NetworkManager.OnQuestList → 퀘스트 목록 갱신
      - NetworkManager.OnQuestAcceptResult → 퀘스트 수락 결과
      - NetworkManager.OnQuestCompleteResult → 퀘스트 완료 결과
      - NetworkManager.OnEnterGame → 자동 QUEST_LIST_REQ
    public_api:
      - AcceptQuest(uint)
      - CheckProgress(uint)
      - CompleteQuest(uint)
      - GetQuest(uint) → QuestInfo
      - HasQuest(uint) → bool

  - name: CraftingManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "제작/요리/인챈트 시스템 관리 — S043 TASK 2 (MsgType 380-383, 386-389)"
    reads: []
    writes:
      - _recipes (List<CraftRecipeInfo>)
      - _isPanelOpen (bool)
    fires_events:
      - OnRecipeListChanged()
      - OnCraftComplete(CraftResultData)
      - OnCookComplete(CookResultData)
      - OnEnchantComplete(EnchantResultData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnCraftList → 레시피 목록 수신
      - NetworkManager.OnCraftResult → 제작 결과
      - NetworkManager.OnCookResult → 요리 결과
      - NetworkManager.OnEnchantResultResp → 인챈트 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - Craft(string)
      - Cook(string)
      - Enchant(byte, byte, byte)
      - RefreshRecipes(byte)
      - GetRecipe(string) → CraftRecipeInfo

  - name: GatheringManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "채집 시스템 관리 — S043 TASK 2 (MsgType 384-385) 에너지/진행바"
    reads: []
    writes:
      - _energy (ushort)
      - _isGathering (bool)
      - _gatherTimer (float)
    fires_events:
      - OnGatherComplete(GatherResultData)
      - OnGatherStarted()
      - OnEnergyChanged()
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnGatherResult → 채집 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - Gather(byte)
      - GetGatherName(byte) → string
    computed_properties:
      - Energy (byte)
      - MaxEnergy (byte)
      - IsGathering (bool)
      - GatherProgress (float)

  - name: GemManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "보석 장착/합성 관리 — S041 TASK 8 (MsgType 450-453)"
    reads: []
    writes:
      - _isPanelOpen (bool)
    fires_events:
      - OnGemEquipped(GemEquipResultData)
      - OnGemFused(GemFuseResultData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnGemEquipResult → 보석 장착 결과
      - NetworkManager.OnGemFuseResult → 보석 합성 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - EquipGem(byte, byte, uint)
      - FuseGems(byte, byte)
      - GetGemTypeName(byte) → string
      - GetTierName(byte) → string

  - name: WeatherManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "날씨/시간 시스템 관리 — 날씨 전환 보간, 게임 시간 추적, 시간대 계산"
    reads: []
    writes:
      - _currentWeather (WeatherType)
      - _gameTimeSec (uint)
      - _transitionTimer (float)
    fires_events:
      - OnWeatherChanged(WeatherType, byte)
      - OnTimeChanged(uint)
    subscribes_to:
      - NetworkManager.OnWeatherUpdate → 날씨 변경
      - NetworkManager.OnTimeUpdate → 게임 시간 갱신
    public_api:
      - GetTimeOfDay() → TimeOfDay
    computed_properties:
      - CurrentWeather (WeatherType)
      - GameTime (uint)
      - TimeOfDay (TimeOfDay)
      - DayProgress (float 0~1)
      - WeatherBlend (float 0~1)

  - name: TeleportManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "텔레포트(워프포인트) 시스템 관리 — 목록 요청/텔레포트 실행/패널 토글"
    reads: []
    writes:
      - _waypoints (List<WaypointInfo>)
      - _isPanelOpen (bool)
    fires_events:
      - OnWaypointsLoaded(WaypointInfo[])
      - OnTeleportComplete(TeleportResultData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnTeleportList → 워프포인트 목록 수신
      - NetworkManager.OnTeleportResult → 텔레포트 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshWaypoints()
      - Teleport(ushort)
    computed_properties:
      - Waypoints (IReadOnlyList<WaypointInfo>)
      - IsPanelOpen (bool)

  - name: MountManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "탈것 시스템 관리 — 소환/해제, 이동 속도 배율 추적"
    reads: []
    writes:
      - _isMounted (bool)
      - _currentMountId (uint)
      - _speedMultiplier (float)
      - _isPanelOpen (bool)
    fires_events:
      - OnMounted(MountResultData)
      - OnDismounted()
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnMountResult → 탈것 소환 결과
      - NetworkManager.OnMountDismountResult → 탈것 해제 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - Summon(uint)
      - Dismount()
    computed_properties:
      - IsMounted (bool)
      - CurrentMountId (uint)
      - SpeedMultiplier (float)
      - IsPanelOpen (bool)

  - name: CashShopManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "캐시샵 시스템 관리 — S042 TASK 11 (MsgType 474-477, 488-489) 아이템 목록/구매/크리스탈/월정액"
    reads: []
    writes:
      - _items (List<CashShopItemInfo>)
      - _crystals (uint)
      - _isPanelOpen (bool)
      - _subscription (SubscriptionInfoData)
    fires_events:
      - OnShopListChanged()
      - OnPurchaseResult(CashShopBuyResultData)
      - OnSubscriptionUpdated(SubscriptionInfoData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnCashShopList → 캐시샵 아이템 목록 수신
      - NetworkManager.OnCashShopBuyResult → 구매 결과
      - NetworkManager.OnSubscriptionInfo → 월정액 정보
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RequestItems(byte)
      - BuyItem(uint, byte)
      - RequestSubscription()
    computed_properties:
      - Items (IReadOnlyList<CashShopItemInfo>)
      - Crystals (uint)
      - IsPanelOpen (bool)
      - Subscription (SubscriptionInfoData)

  - name: BattlePassManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "배틀패스 시스템 관리 — S042 TASK 11 (MsgType 478-483) 시즌 정보/보상 수령/프리미엄 구매"
    reads: []
    writes:
      - _info (BattlePassInfoData)
      - _isPanelOpen (bool)
    fires_events:
      - OnInfoUpdated(BattlePassInfoData)
      - OnRewardClaimed(BattlePassRewardResultData)
      - OnPremiumPurchased(BattlePassBuyResultData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnBattlePassInfo → 배틀패스 정보 수신
      - NetworkManager.OnBattlePassRewardResult → 보상 수령 결과
      - NetworkManager.OnBattlePassBuyResult → 프리미엄 구매 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshInfo()
      - ClaimReward(byte, byte)
      - BuyPremium()
    computed_properties:
      - Info (BattlePassInfoData)
      - IsPanelOpen (bool)
      - IsPremium (bool)
      - Level (byte)
      - ExpRatio (float)

  - name: AttendanceManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "출석 시스템 관리 — 출석 정보, 보상 수령, 일일/주간 리셋, 로그인 보상"
    reads: []
    writes:
      - _info (AttendanceInfoData)
      - _isPanelOpen (bool)
    fires_events:
      - OnInfoUpdated(AttendanceInfoData)
      - OnRewardClaimed(AttendanceClaimResultData)
      - OnDailyReset(DailyResetNotifyData)
      - OnLoginReward(LoginRewardNotifyData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnAttendanceInfo → 출석 정보 수신
      - NetworkManager.OnAttendanceClaimResult → 보상 수령 결과
      - NetworkManager.OnDailyResetNotify → 일일/주간 리셋 알림
      - NetworkManager.OnLoginRewardNotify → 로그인 보상 알림
      - NetworkManager.OnEnterGame → 자동 ATTENDANCE_INFO_REQ
    public_api:
      - OpenPanel()
      - ClosePanel()
      - ClaimDay(byte)
      - RefreshInfo()
    computed_properties:
      - Info (AttendanceInfoData)
      - IsPanelOpen (bool)
      - CurrentDay (byte)
      - TotalDays (byte)

  - name: StoryManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "스토리/대화/컷씬 관리 — 대화 선택지, 컷씬 재생/스킵, 스토리 진행, 메인 퀘스트"
    reads: []
    writes:
      - _currentChapter (byte)
      - _currentQuestId (uint)
      - _mainQuest (MainQuestDataInfo)
      - _isCutscenePlaying (bool)
      - _activeCutsceneId (ushort)
      - _isPanelOpen (bool)
    fires_events:
      - OnDialogWithChoices(DialogChoiceResultData)
      - OnCutsceneStarted(CutsceneTriggerData)
      - OnCutsceneFinished(ushort)
      - OnStoryUpdated(StoryProgressData)
      - OnMainQuestUpdated(MainQuestDataInfo)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnDialogChoiceResult → 대화 선택지 결과
      - NetworkManager.OnCutsceneTrigger → 컷씬 트리거
      - NetworkManager.OnCutsceneEnd → 컷씬 종료
      - NetworkManager.OnStoryProgress → 스토리 진행 갱신
      - NetworkManager.OnMainQuestData → 메인 퀘스트 데이터
    public_api:
      - OpenPanel()
      - ClosePanel()
      - SelectChoice(ushort, byte)
      - SkipCutscene()
      - RefreshProgress()
    computed_properties:
      - CurrentChapter (byte)
      - MainQuest (MainQuestDataInfo)
      - IsCutscenePlaying (bool)
      - IsPanelOpen (bool)

  - name: AuctionManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "거래소/경매장 관리 — 목록 조회, 아이템 등록, 즉시 구매, 입찰"
    reads: []
    writes:
      - _listings (List<AuctionListingInfo>)
      - _currentCategory (byte)
      - _currentPage (byte)
      - _currentSortBy (byte)
      - _totalPages (byte)
      - _totalCount (ushort)
      - _isPanelOpen (bool)
    fires_events:
      - OnListingChanged(List<AuctionListingInfo>)
      - OnRegisterResult(AuctionRegisterResultData)
      - OnBuyResult(AuctionBuyResultData)
      - OnBidResult(AuctionBidResultData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnAuctionList → 거래소 목록 수신
      - NetworkManager.OnAuctionRegisterResult → 등록 결과
      - NetworkManager.OnAuctionBuyResult → 구매 결과
      - NetworkManager.OnAuctionBidResult → 입찰 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RequestListings(byte, byte, byte)
      - NextPage()
      - PrevPage()
      - RegisterItem(byte, byte, uint, byte)
      - BuyItem(uint)
      - PlaceBid(uint, uint)
    computed_properties:
      - Listings (List<AuctionListingInfo>)
      - CurrentPage (byte)
      - TotalPages (byte)
      - IsPanelOpen (bool)

  - name: TripodManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "비급 & 트라이포드 관리 — 목록 조회, 장착, 비급 사용(해금)"
    reads: []
    writes:
      - _skills (List<TripodSkillInfo>)
      - _isPanelOpen (bool)
    fires_events:
      - OnTripodListChanged()
      - OnEquipResult(TripodEquipResult)
      - OnDiscoverResult(ScrollDiscoverResultData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnTripodList → 트라이포드 목록 수신
      - NetworkManager.OnTripodEquipResult → 장착 결과
      - NetworkManager.OnScrollDiscoverResult → 비급 발견 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshList()
      - EquipTripod(ushort, byte, byte)
      - UseScroll(byte)
    computed_properties:
      - Skills (IReadOnlyList<TripodSkillInfo>)
      - IsPanelOpen (bool)

  - name: BountyManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "강호 현상금 시스템 관리 — 목록 조회, 수락, 완료, 랭킹, PvP 현상금"
    reads: []
    writes:
      - _dailyBounties (List<BountyInfo>)
      - _weeklyBounty (BountyInfo)
      - _hasWeekly (bool)
      - _acceptedCount (byte)
      - _isPanelOpen (bool)
    fires_events:
      - OnBountyListChanged()
      - OnAcceptResult(BountyAcceptResultData)
      - OnCompleteResult(BountyCompleteData)
      - OnRankingReceived(BountyRankingData)
      - OnPvPBountyAlert(PvPBountyNotifyData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnBountyList → 현상금 목록 수신
      - NetworkManager.OnBountyAcceptResult → 수락 결과
      - NetworkManager.OnBountyComplete → 완료 결과
      - NetworkManager.OnBountyRanking → 랭킹 수신
      - NetworkManager.OnPvPBountyNotify → PvP 현상금 알림
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshList()
      - AcceptBounty(ushort)
      - CompleteBounty(ushort)
      - RequestRanking()
    computed_properties:
      - DailyBounties (IReadOnlyList<BountyInfo>)
      - WeeklyBounty (BountyInfo)
      - HasWeekly (bool)
      - AcceptedCount (byte)
      - IsPanelOpen (bool)

  - name: DailyQuestManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "일일/주간 퀘스트 관리 — 목록 조회 + 진행 상태 추적"
    reads: []
    writes:
      - _dailyQuests (List<DailyQuestInfo>)
      - _weeklyQuest (WeeklyQuestInfo)
      - _hasWeekly (bool)
      - _isPanelOpen (bool)
    fires_events:
      - OnDailyQuestListChanged()
      - OnWeeklyQuestChanged()
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnDailyQuestList → 일일 퀘스트 목록 수신
      - NetworkManager.OnWeeklyQuest → 주간 퀘스트 수신
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshDailyQuests()
      - RefreshWeeklyQuest()
    computed_properties:
      - DailyQuests (IReadOnlyList<DailyQuestInfo>)
      - WeeklyQuest (WeeklyQuestInfo)
      - HasWeekly (bool)
      - IsPanelOpen (bool)

  - name: ReputationManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "세력 평판 관리 — 평판 조회 + 티어 상태 추적"
    reads: []
    writes:
      - _factions (List<ReputationFactionInfo>)
      - _isPanelOpen (bool)
    fires_events:
      - OnReputationChanged()
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnReputationInfo → 평판 정보 수신
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshReputation()
      - GetFaction(string)
    computed_properties:
      - Factions (IReadOnlyList<ReputationFactionInfo>)
      - IsPanelOpen (bool)

  - name: TitleManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "칭호 시스템 관리 — 목록 조회/장착/해제 + 보너스 표시"
    reads: []
    writes:
      - _titles (List<TitleInfo>)
      - _equippedId (ushort)
      - _isPanelOpen (bool)
    fires_events:
      - OnTitleListChanged()
      - OnEquipResult(TitleEquipResultData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnTitleList → 칭호 목록 수신
      - NetworkManager.OnTitleEquipResult → 장착 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshList()
      - EquipTitle(ushort)
      - UnequipTitle()
      - GetTitle(ushort) → TitleInfo
      - GetEquippedTitleName() → string
    computed_properties:
      - Titles (IReadOnlyList<TitleInfo>)
      - EquippedId (ushort)
      - IsPanelOpen (bool)

  - name: CollectionManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "도감 시스템 관리 — 몬스터 4카테고리 + 장비 5등급 도감 조회"
    reads: []
    writes:
      - _monsterCategories (List<MonsterCollectionCategory>)
      - _equipTiers (List<EquipCollectionTier>)
      - _isPanelOpen (bool)
    fires_events:
      - OnCollectionChanged()
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnCollectionInfo → 도감 정보 수신
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshCollection()
      - GetMonsterCompletionRate() → float
      - GetEquipTotalRegistered() → int
    computed_properties:
      - MonsterCategories (IReadOnlyList<MonsterCollectionCategory>)
      - EquipTiers (IReadOnlyList<EquipCollectionTier>)
      - IsPanelOpen (bool)

  - name: JobChangeUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "2차 전직 UI — 전직 요청/결과 표시 (매니저 없이 직접 NetworkManager 구독)"
    reads: []
    writes:
      - _isPanelOpen (bool)
    fires_events:
      - OnJobChanged(JobChangeResultData)
    subscribes_to:
      - NetworkManager.OnJobChangeResult → 전직 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RequestJobChange(string)
    computed_properties:
      - IsPanelOpen (bool)

  - name: EngravingManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "각인 시스템 관리 — S050 TASK 8 Enhancement (MsgType 454-457) 9종 각인 포인트/활성화"
    reads: []
    writes:
      - _engravings (List<EngravingInfo>)
      - _isPanelOpen (bool)
    fires_events:
      - OnEngravingListChanged()
      - OnEngravingChanged(EngravingResultData)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnEngravingList → 각인 목록 수신
      - NetworkManager.OnEngravingResult → 각인 변경 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshList()
      - ActivateEngraving(string)
      - DeactivateEngraving(string)
      - GetEngraving(string) → EngravingInfo
      - GetActiveCount() → int
    computed_properties:
      - Engravings (IReadOnlyList<EngravingInfo>)
      - IsPanelOpen (bool)

  - name: TranscendUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "초월 UI — S050 TASK 8 Enhancement (MsgType 458-459) 장비 초월 요청/결과 (매니저 없이 직접 NetworkManager 구독)"
    reads: []
    writes:
      - _isPanelOpen (bool)
    fires_events:
      - OnTranscendComplete(TranscendResultData)
    subscribes_to:
      - NetworkManager.OnTranscendResult → 초월 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RequestTranscend(string)
    computed_properties:
      - IsPanelOpen (bool)

  - name: FriendManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "친구 시스템 관리 — S051 TASK 5 (MsgType 410-415) 친구 요청/수락/거절/목록"
    reads: []
    writes:
      - _friends (List<FriendInfo>)
      - _isPanelOpen (bool)
    fires_events:
      - OnFriendListChanged()
      - OnFriendRequestResult(FriendRequestResult)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnFriendList → 친구 목록 수신
      - NetworkManager.OnFriendRequestResult → 친구 요청 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshList()
      - SendFriendRequest(string)
      - AcceptFriend(string)
      - RejectFriend(string)
      - GetFriend(string) → FriendInfo
    computed_properties:
      - Friends (IReadOnlyList<FriendInfo>)
      - IsPanelOpen (bool)
      - OnlineCount (int)

  - name: BlockManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "차단 시스템 관리 — S051 TASK 5 (MsgType 416-419) 차단/해제/목록"
    reads: []
    writes:
      - _blockedNames (List<string>)
      - _isPanelOpen (bool)
    fires_events:
      - OnBlockListChanged()
      - OnBlockResultReceived(BlockPlayerResult)
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnBlockList → 차단 목록 수신
      - NetworkManager.OnBlockResult → 차단 결과
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshList()
      - BlockPlayer(string)
      - UnblockPlayer(string)
      - IsBlocked(string) → bool
    computed_properties:
      - BlockedNames (IReadOnlyList<string>)
      - IsPanelOpen (bool)

  - name: PartyFinderManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "파티 찾기 시스템 관리 — S051 TASK 5 (MsgType 420-422) 파티 찾기 등록/목록/카테고리 필터"
    reads: []
    writes:
      - _listings (List<PartyFinderListingInfo>)
      - _isPanelOpen (bool)
      - _currentCategoryFilter (byte)
    fires_events:
      - OnListingsChanged()
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnPartyFinderList → 파티 찾기 목록 수신
    public_api:
      - OpenPanel()
      - ClosePanel()
      - RefreshList(byte)
      - CreateListing(string, PartyFinderCategory, byte, PartyFinderRole)
    computed_properties:
      - Listings (IReadOnlyList<PartyFinderListingInfo>)
      - IsPanelOpen (bool)
      - CurrentCategoryFilter (byte)

  - name: FriendUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "친구 목록 UI — S051 TASK 5 (O키 토글) 온라인 상태 표시 + 친구 요청 알림"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - FriendManager.OnFriendListChanged → 목록 갱신
      - FriendManager.OnFriendRequestResult → 요청 결과
      - FriendManager.OnPanelOpened → 패널 표시
      - FriendManager.OnPanelClosed → 패널 숨김
    public_api: []
    computed_properties: []

  - name: BlockUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "차단 목록 UI — S051 TASK 5 (Shift+B키 토글) 차단/해제 관리"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - BlockManager.OnBlockListChanged → 목록 갱신
      - BlockManager.OnBlockResultReceived → 차단 결과
      - BlockManager.OnPanelOpened → 패널 표시
      - BlockManager.OnPanelClosed → 패널 숨김
    public_api: []
    computed_properties: []

  - name: PartyFinderUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "파티 찾기 UI — S051 TASK 5 (Y키 토글) 카테고리 필터 + 등록 + 목록"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - PartyFinderManager.OnListingsChanged → 목록 갱신
      - PartyFinderManager.OnPanelOpened → 패널 표시
      - PartyFinderManager.OnPanelClosed → 패널 숨김
    public_api: []
    computed_properties: []

  - name: DurabilityManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "내구도/수리/리롤 관리 — S052 TASK 9 (MsgType 462-467) 내구도 추적/경고/broken 상태/수리/리롤"
    reads: []
    writes:
      - _slotDurability (Dictionary<byte, DurabilityNotifyData>)
      - _isRepairPanelOpen (bool)
      - _isRerollPanelOpen (bool)
    fires_events:
      - OnDurabilityChanged(DurabilityNotifyData)
      - OnDurabilityWarning(byte)
      - OnEquipmentBroken(byte)
      - OnRepairComplete(RepairResultData)
      - OnRerollComplete(RerollResultData)
      - OnRepairPanelOpened()
      - OnRepairPanelClosed()
      - OnRerollPanelOpened()
      - OnRerollPanelClosed()
    subscribes_to:
      - NetworkManager.OnDurabilityNotify → 내구도 알림 수신
      - NetworkManager.OnRepairResult → 수리 결과
      - NetworkManager.OnRerollResult → 리롤 결과
    public_api:
      - OpenRepairPanel()
      - CloseRepairPanel()
      - OpenRerollPanel()
      - CloseRerollPanel()
      - RepairSingle(byte)
      - RepairAll()
      - Reroll(byte, byte[])
      - QueryDurability()
      - GetSlotDurability(byte) → DurabilityNotifyData
      - HasBrokenEquipment() → bool
      - HasLowDurability() → bool
    computed_properties:
      - IsRepairPanelOpen (bool)
      - IsRerollPanelOpen (bool)

  - name: RepairUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "NPC 수리 창 — S052 TASK 9 (F10키 토글) 단일/전체 수리 + 내구도 경고"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - DurabilityManager.OnDurabilityChanged → 내구도 갱신
      - DurabilityManager.OnDurabilityWarning → 경고
      - DurabilityManager.OnEquipmentBroken → 파손
      - DurabilityManager.OnRepairComplete → 수리 결과
      - DurabilityManager.OnRepairPanelOpened → 패널 표시
      - DurabilityManager.OnRepairPanelClosed → 패널 숨김
    public_api: []
    computed_properties: []

  - name: RerollUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "옵션 재감정 창 — S052 TASK 9 (F11키 토글) 잠금 토글 + 결과 표시"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - DurabilityManager.OnRerollComplete → 리롤 결과
      - DurabilityManager.OnRerollPanelOpened → 패널 표시
      - DurabilityManager.OnRerollPanelClosed → 패널 숨김
    public_api: []
    computed_properties: []

  - name: BattlegroundManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "전장/PvP시즌 관리 — S053 TASK 6 (MsgType 430-433)"
    reads: []
    writes:
      - _isQueued (bool)
      - _queueMode (BattlegroundMode)
      - _inMatch (bool)
      - _matchId (uint)
      - _myTeam (BattlegroundTeam)
      - _redScore (uint)
      - _blueScore (uint)
      - _timeRemaining (uint)
    fires_events:
      - OnQueueStatusChanged(BattlegroundStatusData)
      - OnScoreUpdated(BattlegroundScoreUpdateData)
      - OnMatchStarted()
      - OnMatchEnded()
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnBattlegroundStatus → 전장 큐/매칭 상태
      - NetworkManager.OnBattlegroundScoreUpdate → 실시간 점수
    public_api:
      - OpenPanel() / ClosePanel()
      - EnqueueBattleground(mode)
      - CancelQueue()
      - RequestScoreUpdate()
      - GetTierFromRating(rating)
      - GetTierName(tier)
    computed_properties:
      - IsQueued, InMatch, MyTeam, RedScore, BlueScore, TimeRemaining

  - name: GuildWarManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "길드전 관리 — S053 TASK 6 (MsgType 434-435)"
    reads: []
    writes:
      - _inWar (bool)
      - _warId (uint)
      - _guildAId (uint)
      - _guildBId (uint)
      - _crystalHpA (uint)
      - _crystalHpB (uint)
      - _timeRemaining (uint)
    fires_events:
      - OnWarStatusChanged(GuildWarStatusData)
      - OnWarStarted()
      - OnWarEnded()
      - OnPanelOpened()
      - OnPanelClosed()
    subscribes_to:
      - NetworkManager.OnGuildWarStatus → 길드전 상태
    public_api:
      - OpenPanel() / ClosePanel()
      - DeclareWar(targetGuildId)
      - AcceptWar()
      - RejectWar()
      - QueryWarStatus()
    computed_properties:
      - InWar, WarId, CrystalHpA, CrystalHpB, TimeRemaining

  - name: BattlegroundUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "전장 큐/점수판 UI — S053 TASK 6 (F7키 토글)"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - BattlegroundManager.OnPanelOpened → 패널 표시
      - BattlegroundManager.OnPanelClosed → 패널 숨김
      - BattlegroundManager.OnQueueStatusChanged → 큐 상태 갱신
      - BattlegroundManager.OnScoreUpdated → 점수 갱신
      - BattlegroundManager.OnMatchStarted → 매치 시작
      - BattlegroundManager.OnMatchEnded → 매치 종료
    public_api: []
    computed_properties: []

  - name: GuildWarUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "길드전 UI — S053 TASK 6 (F8키 토글) 선언/수락/거절 + 수정HP"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - GuildWarManager.OnPanelOpened → 패널 표시
      - GuildWarManager.OnPanelClosed → 패널 숨김
      - GuildWarManager.OnWarStatusChanged → 길드전 상태 갱신
      - GuildWarManager.OnWarStarted → 길드전 시작
      - GuildWarManager.OnWarEnded → 길드전 종료
    public_api: []
    computed_properties: []

  - name: CurrencyManager
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "보조 화폐/토큰 상점 관리 — S054 TASK 10 (MsgType 468-473) 화폐 5종 + 토큰 상점 3종"
    reads: []
    writes:
      - _gold (uint)
      - _silver (uint)
      - _dungeonToken (uint)
      - _pvpToken (uint)
      - _guildContribution (uint)
      - _isCurrencyPanelOpen (bool)
      - _isTokenShopOpen (bool)
      - _currentShopType (TokenShopType)
      - _currentShopItems (TokenShopItem[])
    fires_events:
      - OnCurrencyChanged(CurrencyInfoData)
      - OnTokenShopListReceived(TokenShopData)
      - OnTokenShopBuyComplete(TokenShopBuyResultData)
      - OnCurrencyPanelOpened()
      - OnCurrencyPanelClosed()
      - OnTokenShopOpened()
      - OnTokenShopClosed()
    subscribes_to:
      - NetworkManager.OnCurrencyInfo → 화폐 정보 수신
      - NetworkManager.OnTokenShop → 토큰 상점 목록 수신
      - NetworkManager.OnTokenShopBuyResult → 구매 결과 수신
    public_api:
      - OpenCurrencyPanel()
      - CloseCurrencyPanel()
      - OpenTokenShop(shopType)
      - CloseTokenShop()
      - QueryCurrency()
      - BuyTokenShopItem(shopId, quantity)
      - GetCurrencyByType(shopType)
      - GetCurrencyName(shopType)
    computed_properties:
      - Gold, Silver, DungeonToken, PvpToken, GuildContribution
      - IsCurrencyPanelOpen, IsTokenShopOpen, CurrentShopType, CurrentShopItems

  - name: CurrencyUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "화폐 표시 패널 — S054 TASK 10 (F9키 토글) 골드/실버/토큰 표시"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - CurrencyManager.OnCurrencyChanged → 화폐 갱신
      - CurrencyManager.OnCurrencyPanelOpened → 패널 표시
      - CurrencyManager.OnCurrencyPanelClosed → 패널 숨김
    public_api: []
    computed_properties: []

  - name: TokenShopUI
    namespace: (global)
    singleton: true
    dont_destroy_on_load: false
    purpose: "토큰 상점 UI — S054 TASK 10 (Shift+F9키 토글) 던전/PvP/길드 상점"
    reads: []
    writes: []
    fires_events: []
    subscribes_to:
      - CurrencyManager.OnTokenShopListReceived → 상점 목록 갱신
      - CurrencyManager.OnTokenShopBuyComplete → 구매 결과
      - CurrencyManager.OnTokenShopOpened → 패널 표시
      - CurrencyManager.OnTokenShopClosed → 패널 숨김
    public_api: []
    computed_properties: []

# ━━━ Entity 컴포넌트 ━━━

entities:

  - name: LocalPlayer
    namespace: (global)
    attached_to: LocalPlayer.prefab
    purpose: "내 캐릭터 — 입력 처리 + 카메라 추적 + 이동 전송"
    reads:
      - Input (WASD / GetAxis)
      - Camera.main
    writes:
      - transform.position, transform.rotation
      - Camera.main.transform (카메라 추적)
    calls:
      - NetworkManager.Instance.SendMove() (sendInterval 간격)
      - CoordConverter.UnityToServer()
    serialized_fields:
      - moveSpeed: float (default 5)
      - sendInterval: float (default 0.1)
      - cameraOffset: Vector3 (default 0,15,-10)
      - cameraSmoothSpeed: float (default 5)

  - name: RemotePlayer
    namespace: (global)
    attached_to: RemotePlayer.prefab
    purpose: "다른 플레이어 — 서버 위치로 보간 이동"
    reads:
      - _targetPos (SetTargetPosition으로 설정됨)
    writes:
      - transform.position, transform.rotation
    calls: []
    serialized_fields:
      - lerpSpeed: float (default 10)

  - name: MonsterEntity
    namespace: (global)
    attached_to: Monster.prefab (또는 런타임 생성 Cube)
    purpose: "몬스터 — 서버 위치로 보간 이동 + HP 추적"
    reads:
      - _targetPos (SetTargetPosition으로 설정됨)
    writes:
      - transform.position
    calls: []
    serialized_fields:
      - lerpSpeed: float (default 10)

# ━━━ 유틸리티 ━━━

utilities:

  - name: TCPClient
    namespace: Network
    purpose: "TCP 소켓 래퍼 — 백그라운드 수신 + 메인 스레드 디큐"
    threading: "수신=백그라운드 스레드, 디큐=메인 스레드(Update)"
    used_by: [NetworkManager]

  - name: PacketBuilder
    namespace: Network
    purpose: "패킷 직렬화/역직렬화 (static 유틸리티)"
    packet_format: "[4B Length LE][2B MsgType LE][Payload]"
    used_by: [NetworkManager]

  - name: CoordConverter
    namespace: (global)
    purpose: "서버↔Unity 좌표 변환"
    conversion:
      server_to_unity: "Vector3(sx * 0.1, 0, sy * 0.1)"
      unity_to_server: "(pos.x * 10, pos.z * 10)"
      server_range: "0~1000 x 0~1000 (2D)"
      unity_range: "0~100 x 0~100 (3D, y=0)"
    used_by: [EntityManager, LocalPlayer]

  - name: ConnectionTest
    namespace: (global)
    purpose: "자동화된 접속 테스트 (Gate→Login→CharSelect→InGame)"
    test_flow:
      - ConnectToGate
      - Login("hero", "pass123") after 1s
      - SelectCharacter(1) on login success
      - JoinChannel(1) on enter game
      - Spacebar → random SendMove

# ━━━ 데이터 흐름 ━━━

data_flows:

  - from: Server (TCP)
    to: TCPClient
    via: "TCP socket (background thread)"
    description: "서버 바이트 스트림 수신 → ReceivedPacket 큐에 적재"

  - from: TCPClient
    to: NetworkManager
    via: "DequeueAll() in Update()"
    description: "메인 스레드에서 패킷 디큐 → 타입별 핸들러 호출"

  - from: NetworkManager
    to: GameManager
    via: "C# events (OnLoginResult, OnEnterGame, OnDisconnected)"
    description: "게임 상태 전이 트리거"

  - from: NetworkManager
    to: EntityManager
    via: "C# events (OnEnterGame, OnEntityAppear/Disappear/Move)"
    description: "엔티티 생명주기 관리"

  - from: EntityManager
    to: EntityPool
    via: "Get()/Return() 직접 호출"
    description: "RemotePlayer 오브젝트 풀링"

  - from: NetworkManager
    to: StatsManager
    via: "C# events (OnStatSync, OnEnterGame)"
    description: "스탯 동기화 + 게임 진입 시 자동 STAT_QUERY"

  - from: NetworkManager
    to: MonsterManager
    via: "C# events (OnMonsterSpawn, OnMonsterRespawn, OnCombatDied, OnEntityMove, OnAttackResult, OnMonsterMove, OnMonsterAggro)"
    description: "몬스터 스폰/리스폰/사망/이동/HP 갱신/어그로"

  - from: MonsterManager
    to: MonsterEntity
    via: "Initialize(), SetTargetPosition() 직접 호출"
    description: "몬스터 데이터 초기화 + 위치 보간 타겟 설정"

  - from: NetworkManager
    to: CombatManager
    via: "C# events (OnAttackResult, OnCombatDied, OnRespawnResult)"
    description: "전투 결과, 사망, 부활 이벤트 전달"

  - from: StatsManager
    to: HUDManager
    via: "C# event (OnStatsChanged)"
    description: "HP/MP/EXP/Level UI 갱신"

  - from: CombatManager
    to: CombatUI
    via: "C# event (OnAttackFeedback)"
    description: "데미지 텍스트 + 타겟 HP바 갱신"

  - from: CombatManager
    to: DeathUI
    via: "C# events (OnEntityDied, OnRespawnComplete)"
    description: "사망 패널 표시/숨김"

  - from: SkillManager
    to: SkillBarUI
    via: "C# events (OnSkillListChanged, OnSkillUsed)"
    description: "스킬 목록 변경 → 슬롯 이름 갱신, 쿨다운 오버레이"

  - from: InventoryManager
    to: InventoryUI
    via: "C# event (OnInventoryChanged)"
    description: "인벤토리 변경 → 아이템 슬롯 리스트 갱신"

  - from: PartyManager
    to: PartyUI
    via: "C# event (OnPartyChanged)"
    description: "파티 상태 변경 → 멤버 리스트/버튼 갱신"

  - from: BuffManager
    to: BuffUI
    via: "C# event (OnBuffListChanged)"
    description: "버프 변경 → 아이콘 리스트 + 타이머 갱신"

  - from: QuestManager
    to: QuestUI
    via: "C# event (OnQuestListChanged)"
    description: "퀘스트 변경 → 리스트 + 진행 상황 갱신"

  - from: NetworkManager
    to: ChatManager
    via: "C# events (OnChatMessage, OnWhisperResult, OnSystemMessage)"
    description: "채팅/귓속말/시스템 메시지 수신"

  - from: ChatManager
    to: ChatUI
    via: "C# event (OnNewMessage)"
    description: "새 메시지 → 채팅 창 갱신"

  - from: NetworkManager
    to: ShopManager
    via: "C# events (OnShopList, OnShopResult)"
    description: "상점 아이템 목록/거래 결과"

  - from: ShopManager
    to: ShopUI
    via: "C# events (OnShopOpened, OnShopClosed, OnTransactionResult, OnGoldChanged)"
    description: "상점 패널 토글 + 아이템/골드 갱신"

  - from: NetworkManager
    to: BossManager
    via: "C# events (OnBossSpawn, OnBossPhaseChange, OnBossSpecialAttack, OnBossEnrage, OnBossDefeated, OnAttackResult)"
    description: "보스 출현/페이즈/특수공격/인레이지/처치/HP 갱신"

  - from: BossManager
    to: BossUI
    via: "C# events (OnBossAppeared, OnBossPhaseChanged, OnBossSpecialAttacked, OnBossEnraged, OnBossKilled, OnBossHPChanged)"
    description: "보스 HP바, 페이즈 표시, 알림 팝업"

  - from: NetworkManager
    to: NpcManager
    via: "C# event (OnNpcDialog)"
    description: "NPC 대화 데이터 수신"

  - from: NpcManager
    to: NpcDialogUI
    via: "C# events (OnDialogOpened, OnDialogClosed)"
    description: "NPC 대화 패널 표시/숨김"

  - from: NetworkManager
    to: EnhanceManager
    via: "C# event (OnEnhanceResult)"
    description: "강화 결과 수신"

  - from: EnhanceManager
    to: EnhanceUI
    via: "C# events (OnEnhanceComplete, OnEnhancePanelOpened, OnEnhancePanelClosed)"
    description: "강화 패널 UI 갱신"

  - from: NetworkManager
    to: TutorialManager
    via: "C# event (OnTutorialReward)"
    description: "튜토리얼 보상 수신"

  - from: NetworkManager
    to: ServerSelectUI
    via: "C# event (OnServerList)"
    description: "서버 목록 수신 → UI 갱신"

  - from: NetworkManager
    to: CharacterSelectUI
    via: "C# events (OnCharacterDataList, OnCharacterCreateResult, OnCharacterDeleteResult)"
    description: "캐릭터 목록/생성/삭제 결과 UI 갱신"

  - from: SceneFlowManager
    to: SceneManager (Unity)
    via: "LoadSceneAsync() 직접 호출"
    description: "페이드 아웃 → 씬 로드 → 페이드 인 (0.5초 트랜지션)"

  - from: LocalPlayer
    to: NetworkManager
    via: "SendMove() 직접 호출"
    description: "WASD 입력 → 서버 이동 패킷 전송 (0.1초 간격)"

  - from: EntityManager
    to: RemotePlayer
    via: "SetTargetPosition() 직접 호출"
    description: "서버 위치 → 보간 타겟 설정"

  - from: NetworkManager
    to: GuildManager
    via: "C# events (OnGuildInfo, OnGuildList)"
    description: "문파 정보/목록 수신"

  - from: GuildManager
    to: GuildUI
    via: "C# events (OnGuildInfoUpdated, OnGuildListReceived, OnGuildLeft)"
    description: "문파 UI 갱신 (G키 토글)"

  - from: NetworkManager
    to: TradeManager
    via: "C# event (OnTradeResult)"
    description: "거래 결과 수신"

  - from: TradeManager
    to: TradeUI
    via: "C# events (OnTradeStarted, OnTradeCancelled, OnTradeCompleted)"
    description: "거래 UI 패널 표시/숨김"

  - from: NetworkManager
    to: MailManager
    via: "C# events (OnMailList, OnMailRead, OnMailClaimResult, OnMailDeleteResult)"
    description: "우편 목록/내용/수령/삭제 결과 수신"

  - from: MailManager
    to: MailUI
    via: "C# events (OnMailListChanged, OnMailOpened, OnClaimResult, OnDeleteResult)"
    description: "우편함 UI 갱신 (M키 토글)"

  - from: NetworkManager
    to: DungeonManager
    via: "C# events (OnInstanceEnter, OnInstanceLeaveResult, OnInstanceInfo, OnMatchFound, OnMatchStatus)"
    description: "던전 입장/퇴장/정보/매칭 이벤트 수신"

  - from: DungeonManager
    to: DungeonUI
    via: "C# events (OnDungeonEntered, OnDungeonLeft, OnDungeonInfoUpdated, OnMatchFound, OnMatchStateChanged)"
    description: "던전 UI 갱신 (J키 토글)"

  - from: NetworkManager
    to: PvPManager
    via: "C# events (OnPvPQueueStatus, OnPvPMatchFound, OnPvPMatchStart, OnPvPAttackResult, OnPvPMatchEnd, OnPvPRatingInfo)"
    description: "PvP 전용 패킷(350-359) 큐/매칭/전투/레이팅 수신"

  - from: PvPManager
    to: PvPUI
    via: "C# events (OnStateChanged, OnMatchFound, OnMatchEnded, OnRatingUpdated)"
    description: "PvP UI 갱신 (K키 토글)"

  - from: NetworkManager
    to: RaidManager
    via: "C# events (OnRaidBossSpawn, OnRaidPhaseChange, OnRaidMechanic, OnRaidMechanicResult, OnRaidStagger, OnRaidEnrage, OnRaidWipe, OnRaidClear, OnRaidAttackResult, OnInstanceEnter, OnInstanceLeaveResult)"
    description: "레이드 보스 패킷(370-379) + 인스턴스 입장/퇴장"

  - from: RaidManager
    to: RaidUI
    via: "C# events (OnBossSpawned, OnPhaseChanged, OnMechanicStarted, OnMechanicResult, OnStaggerUpdated, OnEnraged, OnWiped, OnCleared, OnAttackResult)"
    description: "레이드 보스 UI (HP바/페이즈/기믹/스태거/보상)"

  - from: NetworkManager
    to: CraftingManager
    via: "C# events (OnCraftList, OnCraftResult, OnCookResult, OnEnchantResultResp)"
    description: "제작/요리/인챈트 결과 수신 (380-389)"

  - from: CraftingManager
    to: CraftingUI
    via: "C# events (OnRecipeListChanged, OnCraftComplete, OnCookComplete, OnEnchantComplete, OnPanelOpened, OnPanelClosed)"
    description: "제작 UI 갱신 (N키 토글)"

  - from: NetworkManager
    to: GatheringManager
    via: "C# event (OnGatherResult)"
    description: "채집 결과 수신 (384-385)"

  - from: GatheringManager
    to: GatheringUI
    via: "C# events (OnGatherComplete, OnGatherStarted, OnEnergyChanged, OnPanelOpened, OnPanelClosed)"
    description: "채집 UI 갱신 (진행바+에너지)"

  - from: NetworkManager
    to: GemManager
    via: "C# events (OnGemEquipResult, OnGemFuseResult)"
    description: "보석 장착/합성 결과 수신 (450-453)"

  - from: GemManager
    to: GemUI
    via: "C# events (OnGemEquipped, OnGemFused, OnPanelOpened, OnPanelClosed)"
    description: "보석 UI 갱신"

  - from: NetworkManager
    to: WeatherManager
    via: "C# events (OnWeatherUpdate, OnTimeUpdate)"
    description: "날씨 변경/게임 시간 갱신 수신 (490-491)"

  - from: NetworkManager
    to: TeleportManager
    via: "C# events (OnTeleportList, OnTeleportResult)"
    description: "워프포인트 목록/텔레포트 결과 수신 (492-495)"

  - from: TeleportManager
    to: TeleportUI
    via: "C# events (OnWaypointsLoaded, OnTeleportComplete, OnPanelOpened, OnPanelClosed)"
    description: "텔레포트 UI 갱신 (;키 토글)"

  - from: NetworkManager
    to: MountManager
    via: "C# events (OnMountResult, OnMountDismountResult)"
    description: "탈것 소환/해제 결과 수신 (498-501)"

  - from: MountManager
    to: MountUI
    via: "C# events (OnMounted, OnDismounted, OnPanelOpened, OnPanelClosed)"
    description: "탈것 UI 갱신 (소환/해제 버튼 토글)"

  - from: NetworkManager
    to: CashShopManager
    via: "C# events (OnCashShopList, OnCashShopBuyResult, OnSubscriptionInfo)"
    description: "캐시샵 아이템 목록/구매 결과/월정액 정보 수신 (474-477, 488-489)"

  - from: CashShopManager
    to: CashShopUI
    via: "C# events (OnShopListChanged, OnPurchaseResult, OnSubscriptionUpdated, OnPanelOpened, OnPanelClosed)"
    description: "캐시샵 UI 갱신 ($키 토글)"

  - from: NetworkManager
    to: BattlePassManager
    via: "C# events (OnBattlePassInfo, OnBattlePassRewardResult, OnBattlePassBuyResult)"
    description: "배틀패스 정보/보상/프리미엄 구매 결과 수신 (478-483)"

  - from: BattlePassManager
    to: BattlePassUI
    via: "C# events (OnInfoUpdated, OnRewardClaimed, OnPremiumPurchased, OnPanelOpened, OnPanelClosed)"
    description: "배틀패스 UI 갱신 (F5키 토글)"

  - from: NetworkManager
    to: AttendanceManager
    via: "C# events (OnAttendanceInfo, OnAttendanceClaimResult, OnDailyResetNotify, OnLoginRewardNotify, OnEnterGame)"
    description: "출석 정보/보상/리셋/로그인 보상 수신 + 게임 진입 시 자동 요청 (502-509)"

  - from: AttendanceManager
    to: AttendanceUI
    via: "C# events (OnInfoUpdated, OnRewardClaimed, OnPanelOpened, OnPanelClosed)"
    description: "출석 UI 갱신 (14일 그리드 + 보상 수령)"

  - from: NetworkManager
    to: ContentUnlockUI
    via: "C# event (OnContentUnlockNotify)"
    description: "컨텐츠 해금 알림 → 풀스크린 팝업 (매니저 없이 직접 구독, 507-508)"

  - from: NetworkManager
    to: StoryManager
    via: "C# events (OnDialogChoiceResult, OnCutsceneTrigger, OnCutsceneEnd, OnStoryProgress, OnMainQuestData)"
    description: "대화 선택지/컷씬/스토리 진행/메인 퀘스트 수신 (510-517)"

  - from: StoryManager
    to: StoryUI
    via: "C# events (OnDialogWithChoices, OnCutsceneStarted, OnCutsceneFinished, OnStoryUpdated, OnMainQuestUpdated, OnPanelOpened, OnPanelClosed)"
    description: "스토리 UI 갱신 (대화 선택지 + 컷씬 오버레이 + 퀘스트 진행)"

  - from: NetworkManager
    to: AuctionManager
    via: "C# events (OnAuctionList, OnAuctionRegisterResult, OnAuctionBuyResult, OnAuctionBidResult)"
    description: "거래소 목록/등록 결과/구매 결과/입찰 결과 수신 (390-397)"

  - from: AuctionManager
    to: AuctionUI
    via: "C# events (OnListingChanged, OnRegisterResult, OnBuyResult, OnBidResult, OnPanelOpened, OnPanelClosed)"
    description: "거래소 UI 갱신 (Y키 토글)"

  - from: NetworkManager
    to: TripodManager
    via: "C# events (OnTripodList, OnTripodEquipResult, OnScrollDiscoverResult)"
    description: "트라이포드 목록/장착 결과/비급 발견 결과 수신 (520-524)"

  - from: TripodManager
    to: TripodUI
    via: "C# events (OnTripodListChanged, OnEquipResult, OnDiscoverResult, OnPanelOpened, OnPanelClosed)"
    description: "트라이포드 UI 갱신 (T키 토글)"

  - from: NetworkManager
    to: BountyManager
    via: "C# events (OnBountyList, OnBountyAcceptResult, OnBountyComplete, OnBountyRanking, OnPvPBountyNotify)"
    description: "현상금 목록/수락 결과/완료 결과/랭킹/PvP 현상금 수신 (530-537)"

  - from: BountyManager
    to: BountyUI
    via: "C# events (OnBountyListChanged, OnAcceptResult, OnCompleteResult, OnRankingReceived, OnPvPBountyAlert, OnPanelOpened, OnPanelClosed)"
    description: "현상금 UI 갱신 (B키 토글)"

  - from: NetworkManager
    to: DailyQuestManager
    via: "C# events (OnDailyQuestList, OnWeeklyQuest)"
    description: "일일/주간 퀘스트 목록 수신 (400-403)"

  - from: DailyQuestManager
    to: DailyQuestUI
    via: "C# events (OnDailyQuestListChanged, OnWeeklyQuestChanged, OnPanelOpened, OnPanelClosed)"
    description: "일일/주간 퀘스트 UI 갱신 (L키 토글)"

  - from: NetworkManager
    to: ReputationManager
    via: "C# events (OnReputationInfo)"
    description: "평판 정보 수신 (404-405)"

  - from: ReputationManager
    to: ReputationUI
    via: "C# events (OnReputationChanged, OnPanelOpened, OnPanelClosed)"
    description: "평판 UI 갱신 (N키 토글)"

  - from: NetworkManager
    to: TitleManager
    via: "C# events (OnTitleList, OnTitleEquipResult)"
    description: "칭호 목록/장착 결과 수신 (440-443)"

  - from: TitleManager
    to: TitleUI
    via: "C# events (OnTitleListChanged, OnEquipResult, OnPanelOpened, OnPanelClosed)"
    description: "칭호 UI 갱신 (H키 토글)"

  - from: NetworkManager
    to: CollectionManager
    via: "C# event (OnCollectionInfo)"
    description: "도감 정보 수신 (444-445)"

  - from: CollectionManager
    to: CollectionUI
    via: "C# events (OnCollectionChanged, OnPanelOpened, OnPanelClosed)"
    description: "도감 UI 갱신 (F6키 토글)"

  - from: NetworkManager
    to: JobChangeUI
    via: "C# event (OnJobChangeResult)"
    description: "2차 전직 결과 수신 (446-447, 매니저 없이 직접 구독)"

  - from: NetworkManager
    to: EngravingManager
    via: "C# events (OnEngravingList, OnEngravingResult)"
    description: "각인 목록/변경 결과 수신 (454-457)"

  - from: EngravingManager
    to: EngravingUI
    via: "C# events (OnEngravingListChanged, OnEngravingChanged, OnPanelOpened, OnPanelClosed)"
    description: "각인 UI 갱신 (F9키 토글)"

  - from: NetworkManager
    to: TranscendUI
    via: "C# event (OnTranscendResult)"
    description: "초월 결과 수신 (458-459, 매니저 없이 직접 구독)"

  - from: NetworkManager
    to: FriendManager
    via: "C# events (OnFriendList, OnFriendRequestResult)"
    description: "친구 목록/요청 결과 수신 (410-415)"

  - from: FriendManager
    to: FriendUI
    via: "C# events (OnFriendListChanged, OnFriendRequestResult, OnPanelOpened, OnPanelClosed)"
    description: "친구 UI 갱신 (O키 토글)"

  - from: NetworkManager
    to: BlockManager
    via: "C# events (OnBlockList, OnBlockResult)"
    description: "차단 목록/결과 수신 (416-419)"

  - from: BlockManager
    to: BlockUI
    via: "C# events (OnBlockListChanged, OnBlockResultReceived, OnPanelOpened, OnPanelClosed)"
    description: "차단 UI 갱신 (Shift+B키 토글)"

  - from: NetworkManager
    to: PartyFinderManager
    via: "C# event (OnPartyFinderList)"
    description: "파티 찾기 목록 수신 (420-422)"

  - from: PartyFinderManager
    to: PartyFinderUI
    via: "C# events (OnListingsChanged, OnPanelOpened, OnPanelClosed)"
    description: "파티 찾기 UI 갱신 (Y키 토글)"

  - from: NetworkManager
    to: DurabilityManager
    via: "C# events (OnDurabilityNotify, OnRepairResult, OnRerollResult)"
    description: "내구도 알림/수리 결과/리롤 결과 수신 (462-467)"

  - from: DurabilityManager
    to: RepairUI
    via: "C# events (OnDurabilityChanged, OnDurabilityWarning, OnEquipmentBroken, OnRepairComplete, OnRepairPanelOpened, OnRepairPanelClosed)"
    description: "수리 UI 갱신 (F10키 토글)"

  - from: DurabilityManager
    to: RerollUI
    via: "C# events (OnRerollComplete, OnRerollPanelOpened, OnRerollPanelClosed)"
    description: "리롤 UI 갱신 (F11키 토글)"

  # S053: 전장/길드전 (TASK 6)
  - from: NetworkManager
    to: BattlegroundManager
    via: "C# events (OnBattlegroundStatus, OnBattlegroundScoreUpdate)"
    description: "전장 큐/매칭/점수 수신 (430-433)"

  - from: BattlegroundManager
    to: BattlegroundUI
    via: "C# events (OnQueueStatusChanged, OnScoreUpdated, OnMatchStarted, OnMatchEnded, OnPanelOpened, OnPanelClosed)"
    description: "전장 UI 갱신 (F7키 토글)"

  - from: NetworkManager
    to: GuildWarManager
    via: "C# events (OnGuildWarStatus)"
    description: "길드전 상태 수신 (434-435)"

  - from: GuildWarManager
    to: GuildWarUI
    via: "C# events (OnWarStatusChanged, OnWarStarted, OnWarEnded, OnPanelOpened, OnPanelClosed)"
    description: "길드전 UI 갱신 (F8키 토글)"

  # S054: 보조 화폐/토큰 상점 (TASK 10)
  - from: NetworkManager
    to: CurrencyManager
    via: "C# events (OnCurrencyInfo, OnTokenShop, OnTokenShopBuyResult)"
    description: "화폐 정보/토큰 상점/구매 결과 수신 (468-473)"

  - from: CurrencyManager
    to: CurrencyUI
    via: "C# events (OnCurrencyChanged, OnCurrencyPanelOpened, OnCurrencyPanelClosed)"
    description: "화폐 UI 갱신 (F9키 토글)"

  - from: CurrencyManager
    to: TokenShopUI
    via: "C# events (OnTokenShopListReceived, OnTokenShopBuyComplete, OnTokenShopOpened, OnTokenShopClosed)"
    description: "토큰 상점 UI 갱신 (Shift+F9키 토글)"

# ━━━ 좌표 변환 파이프라인 ━━━

coordinate_pipeline:
  description: "서버(2D 0~1000) ↔ Unity(3D 0~100) 변환"
  steps:
    - name: "서버 → Unity (수신)"
      trigger: "OnEntityAppear, OnEntityMove, OnEnterGame"
      function: "CoordConverter.ServerToUnity(sx, sy)"
      mapping: "x=sx*0.1, y=0, z=sy*0.1"
    - name: "Unity → 서버 (송신)"
      trigger: "LocalPlayer.HandleMovement()"
      function: "CoordConverter.UnityToServer(pos)"
      mapping: "sx=pos.x*10, sy=pos.z*10"
  warning: "서버 Y축 → Unity Z축 매핑에 주의"
