# ============================================================
# Secret Realm Conditions — 비경 탐험 데이터 테이블
# Reference: _gdd/rules/secret_realm.yaml
# Used by: tcp_bridge.py (TASK 17, MsgType 540-544)
# ============================================================

# ── 비경 5종 기본 정보 ──
realm_types:
  trial:
    name: "시련의 방"
    icon: "sword_icon"
    time_limit: 300
    desc: "웨이브 형식 전투 챌린지. 5웨이브 생존."
    waves: 5
    wave_monsters: [3, 5, 7, 10, 1]
    rest_between_waves: 5
    monster_level: "player_level + 2"
    grade_criteria: clear_time
    grade_thresholds:
      S: 180    # 3분 이내
      A: 240    # 4분 이내
      B: 280    # 4분 40초
      C: 300    # 클리어만
    rewards:
      S: { gold: 3000, equipment_box: "rare+", scroll_chance: 0.3 }
      A: { gold: 2000, equipment_box: "uncommon+", scroll_chance: 0.1 }
      B: { gold: 1000, materials: 5 }
      C: { gold: 500, materials: 2 }

  wisdom:
    name: "지혜의 방"
    icon: "book_icon"
    time_limit: 240
    desc: "퍼즐/기믹 챌린지. 함정 회피 + 레버 퍼즐."
    puzzle_types: ["lever_sequence", "floor_pattern", "symbol_match", "pressure_plate"]
    traps: ["spike_floor", "arrow_wall", "poison_gas", "falling_rocks"]
    puzzles_per_room: 3
    hint_system: true
    grade_criteria: clear_time_hints
    grade_thresholds:
      S: { time: 120, hints: 0 }
      A: { time: 180, hints: 1 }
      B: { time: 240, hints: 2 }
      C: { time: 240, hints: 3 }
    rewards:
      S: { gold: 2000, crafting_materials: "rare", scroll_chance: 0.2 }
      A: { gold: 1500, crafting_materials: "uncommon" }
      B: { gold: 800, crafting_materials: "common" }
      C: { gold: 400 }

  treasure:
    name: "보물의 방"
    icon: "chest_icon"
    time_limit: 180
    desc: "파쿠르 + 수집 챌린지. 제한시간 내 보물 상자 최대한 열기."
    chest_count: 20
    trap_chests: 3
    golden_chest: 1
    grade_criteria: chests_opened
    grade_thresholds:
      S: 18
      A: 14
      B: 10
      C: 5
    rewards:
      S: { gold: 5000, random_items: 5, golden_chest_bonus: "epic_item" }
      A: { gold: 3000, random_items: 3 }
      B: { gold: 1500, random_items: 2 }
      C: { gold: 500, random_items: 1 }

  training:
    name: "수련의 방"
    icon: "meditation_icon"
    time_limit: 300
    desc: "스킬 연마 챌린지. 콤보/회피/스킬 패턴 완벽 수행."
    phases:
      - { name: "콤보 연습", count: 10 }
      - { name: "회피 연습", count: 5 }
      - { name: "스킬 연쇄", count: 3 }
    grade_criteria: fail_count
    grade_thresholds:
      S: 0
      A: 2
      B: 5
      C: 99
    rewards:
      S: { exp: 5000, scroll_guaranteed: "tier_1~2", skill_point: 1 }
      A: { exp: 3000, scroll_chance: 0.5 }
      B: { exp: 2000 }
      C: { exp: 1000 }

  fortune:
    name: "운명의 방"
    icon: "dice_icon"
    time_limit: 120
    desc: "랜덤 보상 룸. 선택지 기반 도박/행운 챌린지."
    choices: 5
    choice_types:
      - "상자 3개 중 1개 선택"
      - "동전 던지기 (앞면: 2배, 뒷면: 0)"
      - "룰렛 (대박1/중박2/소박2/꽝1)"
      - "몬스터 택 1 (보물 드롭)"
      - "최종: 확정 vs 올인"
    grade_criteria: luck_score
    grade_thresholds:
      S: 80
      A: 50
      B: 20
      C: 0
    rewards:
      S: { gold: 20000, legendary_material: 1 }
      A: { gold: 5000, rare_material: 3 }
      B: { gold: 1000, materials: 5 }
      C: { gold: 100 }

# ── 날씨+시간 특수 비경 4종 ──
special_conditions:
  night_fog:
    weather: fog
    time_of_day: night
    realm_variant: ghost_trial
    name: "유령의 시련"
    desc: "시야 극도 제한 + 유령 몬스터. S등급 시 epic 비급 확정."
    bonus_multiplier: 2.0
    special_drops: ["epic_scroll_ghost"]
    ambient: "보라색 안개 + 유령 효과음"

  storm_noon:
    weather: storm
    time_of_day: noon
    realm_variant: thunder_training
    name: "뇌신의 수련장"
    desc: "번개 원소 강화 환경. 번개 스킬 스크롤 드롭률 UP."
    bonus_multiplier: 1.5
    special_drops: ["lightning_scroll_t2"]
    ambient: "번개 + 비 + 어두운 하늘"

  snow_dawn:
    weather: snow
    time_of_day: dawn
    realm_variant: crystal_treasure
    name: "수정 보물고"
    desc: "얼음 결정 테마 보물의 방. 보석 드롭 보너스."
    bonus_multiplier: 1.5
    special_drops: ["ice_gem_rare"]
    ambient: "눈결정 + 새벽 빛"

  clear_evening:
    weather: clear
    time_of_day: evening
    realm_variant: fortune_garden
    name: "운명의 정원"
    desc: "특별 운명의 방. 잭팟 확률 2배."
    bonus_multiplier: 1.5
    special_drops: ["fortune_coin"]
    ambient: "석양 빛 + 꽃잎 날림"

  spawn_chance: 0.5  # 조건 충족 시 50% 확률 즉시 스폰

# ── 비경 공통 설정 ──
common_settings:
  unlock_level: 20
  daily_limit: 3
  reset_time: "06:00"
  party_size: [1, 2]
  spawn_interval: [300, 900]  # 5~15분
  per_zone: 1
  portal_duration: 300  # 5분 후 소멸
  eligible_zones: [1, 2, 3, 4, 5, 6, 7]
  visual: "동양풍 회전 문양 포탈 (보라색 빛)"
  minimap_icon: "purple_diamond"
  notification: "zone_broadcast"

# ── 비경 도감 ──
collection:
  trial_master:    { condition: "시련의 방 S등급 10회", bonus: { atk: 15 }, title: "시련의 패자" }
  wisdom_master:   { condition: "지혜의 방 S등급 10회", bonus: { int: 15 }, title: "지혜의 현자" }
  treasure_master: { condition: "보물의 방 S등급 10회", bonus: { luk: 15 }, title: "보물 사냥꾼" }
  training_master: { condition: "수련의 방 S등급 10회", bonus: { all_stats: 3 }, title: "무예의 달인" }
  fortune_master:  { condition: "운명의 방 잭팟 3회",   bonus: { luk: 20 }, title: "운명의 총아" }
  all_complete:    { condition: "모든 비경 마스터",       bonus: { all_stats: 5 }, title: "비경 정복자", cosmetic: "비경 오라" }
